Private Function BuildFacilityOrder(ByVal m As Long) As Long()

    Dim idx() As Long
    Dim key() As Double
    Dim i As Long, a As Long, b As Long
    Dim tmpIdx As Long, tmpKey As Double

    ReDim idx(1 To m)
    ReDim key(1 To m)

    For i = 1 To m
        idx(i) = i
        ' Interest Rate only
        key(i) = NzDbl(Sheets("Facility").Range("AK" & (7 + i)).Value)
    Next i

    ' Bubble sort (descending)
    For a = 1 To m - 1
        For b = a + 1 To m
            If (key(b) > key(a)) Or ((key(b) = key(a)) And idx(b) < idx(a)) Then

                tmpKey = key(a)
                key(a) = key(b)
                key(b) = tmpKey

                tmpIdx = idx(a)
                idx(a) = idx(b)
                idx(b) = tmpIdx

            End If
        Next b
    Next a

    BuildFacilityOrder = idx

End Function
