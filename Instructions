import pandas as pd

# Load the Daily BO file, Report 2 tab.
# The first row is always empty, so we tell pandas to skip it (header=1).
df_rdp = pd.read_excel(
    "01_Raw/RDP Daily BO.xlsx",
    sheet_name="Report 2",
    header=1
).dropna(how="all")   # Just cleaning up any fully empty rows.

# Load the file that contains the list of SCU customers we actually care about.
df_scu = pd.read_excel("01_Raw/SCU_ActiveUniverse.xlsx")

# These are the column names for the CIF fields in both files.
# If your files use slightly different names, adjust here.
cif_rdp_col = "CIF Customer Id"
cif_scu_col = "CIF Customer Id"

# Here I'm filtering Report 2 to keep ONLY the customers that appear in the SCU list.
df_filtered = df_rdp[df_rdp[cif_rdp_col].isin(df_scu[cif_scu_col])]

# Save the filtered dataset â€” this is the actual SCU customer repository update.
df_filtered.to_excel("03_Outputs/CustomerRepository_Update.xlsx", index=False)

print("SCU subset created:", df_filtered.shape[0], "rows")
