Private Function GetFacilityOrderMode() As Long
    Dim ans As Variant

    Do
        ans = Application.InputBox( _
            Prompt:="Choose facility ordering for Generate Template Table:" & vbCrLf & vbCrLf & _
                    "1 = Net Outstanding (descending)" & vbCrLf & _
                    "2 = Interest Rate (descending)", _
            Title:="Facility Ordering", Type:=1)

        If ans = False Then
            'User pressed Cancel -> default to Net Outstanding
            GetFacilityOrderMode = 1
            Exit Function
        End If

        If CLng(ans) = 1 Or CLng(ans) = 2 Then
            GetFacilityOrderMode = CLng(ans)
            Exit Function
        Else
            MsgBox "Please enter 1 or 2.", vbExclamation
        End If
    Loop
End Function
