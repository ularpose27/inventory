import pandas as pd

# --- 1. Make sure Facility Grade is numeric (if it's not already) ---
# This creates a helper numeric column; errors='coerce' turns junk into NaN.
df_dailybo['Facility Grade_num'] = pd.to_numeric(
    df_dailybo['Facility Grade'], 
    errors='coerce'
)

# --- 2. Group by CIF and compute best / worst facility grade ---
grp = df_dailybo.groupby('CIF Customer Id')['Facility Grade_num']

# Best = lowest grade number
df_dailybo['Best_Facility_Grade'] = grp.transform('min')

# Worst = highest grade number
df_dailybo['Worst_Facility_Grade'] = grp.transform('max')

# --- 3. (Optional) drop the helper numeric column if you don't want it ---
# df_dailybo.drop(columns=['Facility Grade_num'], inplace=True)
