def _is_total_row(df: pd.DataFrame) -> pd.Series:
    biz = df.get("Business", pd.Series(index=df.index, dtype="string")).astype("string")
    biz_norm = biz.fillna("").str.strip().str.lower()   # <-- prevents <NA> in the mask
    return biz_norm.eq("total")

m_total = _is_total_row(df_managed_raw).fillna(False)
s_total = _is_total_row(df_shadows_raw).fillna(False)
r_total = _is_total_row(df_resolved_raw).fillna(False)
