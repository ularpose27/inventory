if os.path.exists(file_path):
    try:
        # Attempt to read the Excel file
        df = pd.read_excel(file_path)
        print("The path was correct. The Excel file has been successfully loaded.")
    except Exception as e:
        # If there's an error reading the file, it might not be a valid Excel file
        print(f"An error occurred while trying to read the Excel file: {e}")
else:
    # If the path does not exist, send a message to verify the path
    print("Please verify the path.")




import pandas as pd

# Load the Excel files into DataFrames
current = pd.read_excel("Current.xlsx")
industry = pd.read_excel("Industry.xlsx")

# Join the "SIC Code" column from 'current' into 'industry' based on "Customer Name"
# Assuming "Customer Name" is unique and present in both DataFrames
merged_df = industry.merge(current[['Customer Name', 'SIC Code']], on="Customer Name", how="left")

# If you want to overwrite the 'industry' DataFrame with the merged DataFrame
industry = merged_df

# If you need to save the merged DataFrame to a new Excel file
# industry.to_excel("Merged_Data.xlsx", index=False)

print(industry)









# Rename the columns in 'prev' DataFrame before merging
prev_renamed = prev.rename(columns={
    'Master Total Approved': 'Master Total Approved prev',
    '*Cat A Money': '*Cat A Money prev',
    '*Cat B Money': '*Cat B Money prev',
    '*Cat S Money': '*Cat S Money prev'
})

# Merge 'current' and 'prev_renamed' DataFrames on 'CIF Customer'
difference_df = pd.merge(current, prev_renamed[['CIF Customer', 'Master Total Approved prev', '*Cat A Money prev', '*Cat B Money prev', '*Cat S Money prev']],
                         on='CIF Customer', how='left')

# Calculate the new columns based on the difference
difference_df['New Cat A Money'] = difference_df['*Cat A Money'] - difference_df['*Cat A Money prev']
difference_df['New Cat B Money'] = difference_df['*Cat B Money'] - difference_df['*Cat B Money prev']
difference_df['New Cat S Money'] = difference_df['*Cat S Money'] - difference_df['*Cat S Money prev']
difference_df['Total New Money'] = difference_df['Master Total Approved'] - difference_df['Master Total Approved prev']
